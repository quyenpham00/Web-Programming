<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Product Management System</title>

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
        <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

        <style type="text/css">
            header {
                text-align: center;
                background-color: #111;
                color: #fff;
                font-size: 20px;
                font-weight: bold;
                padding: 20px;
            }
            .left-side {
                background-color: #eee;
                padding-top: 15px;
            }
            .BrandList li { cursor: pointer; }

            main { padding: 10px; }
            .card-header {
                margin-bottom: 20px;
                font-weight: bold;
            }
            .Title, label { font-weight: bold; }
            .NewProduct {
                margin-bottom: 40px;
                padding-bottom: 20px;
            }
            #Submit {
                padding-left: 20px;
                padding-right: 20px;
            }            
            .GroupElements { padding: 0px 10px; }
            .group-List img {
                max-width: 100px;
                height: auto;
            }
            
            .group-List .row { margin-top: 20px; }
            footer {
                padding: 20px 0px;  
                background: #111;
                text-align: center;
                font-weight: bold;
                color: #fff;
            }
        </style>        
    </head>

    <body>
        <header>
            PRODUCT MANAGEMENT SYSTEM              
        </header>

        <div class="container-fluid">
            <div class="row">
                <div class="col-2 left-side">
                    <h2>Brand List</h2>
                    <ul class="BrandList">
                    	<!-- <li>Item 1</li>
                    	<li>Item 2</li> -->
                    </ul>
                </div>

                <div class="col-10">
                    <main class="main-content"> 
                        <section class="NewProduct">                 
                            <div class="card-header">
                                Add a new product
                            </div>                                

                            <div class="GroupElements">
                                <div class="row">
                                    <div class="col-6">
                                        <div class="form-group row">
                                            <label class="col-sm-2 col-form-label">Product Name</label>
                                            <div class="col-sm-10">
                                                <input id="name"type="text" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-group row">
                                            <label class="col-sm-2 col-form-label">Price</label>
                                            <div class="col-sm-10">
                                                <input id="price"type="text" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-6">
                                        <div class="form-group row">
                                            <label class="col-sm-2 col-form-label">Quantity</label>
                                            <div class="col-sm-10">
                                                <input id="quantity" type="text" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-group row">
                                            <label class="col-sm-2 col-form-label">Image Link</label>
                                            <div class="col-sm-10">
                                                <input id="img" type="text" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-6">
                                        <div class="form-group row">
                                            <label class="col-sm-2 col-form-label">Description</label>
                                            <div class="col-sm-10">
                                                <textarea id="description" class="form-control" rows="3"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-group row">
                                            <label class="col-sm-2 col-form-label">Brand</label>
                                            <div class="col-sm-10">
                                                <select id="option"class="form-control">
                                                	<!-- <option value="Brand 1">Brand 1</option>
                                                	<option value="Brand 2">Brand 2</option> -->
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="offset-md-1 col-sm-11">
                                        <button id="btn-add" type="button" class="btn btn-primary" >Add</button>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <!-- End of the form section -->

                        <section class="group-Title">
                            <div class="card-header">
                                <div class="row">
                                    <div class="col-8">
                                        <h3 class="student-list">PRODUCT LIST</h3>
                                    </div>
                                    <div class="col-3">
                                        <input id ="search"type="text" class="form-control" placeholder="Product Name">
                                    </div>
                                    <div class="col-1">
                                        <button id ="btn-search"class="form-control" type="button">Search</button>
                                    </div>
                                </div>                        
                            </div>
                            <div class="row">
                                <div class="col-1 Title">#</div>
                                <div class="col-1 Title">Image</div>
                                <div class="col-2 Title">Product Name</div>                   
                                <div class="col-2 Title">Price</div>
                                <div class="col-1 Title">Quantity</div>
                                <div class="col-4 Title">Description</div>
                                <div class="col-1 Title">Function</div>
                            </div>
                        </section>
                        <!-- End of the product title group -->

                        <section class="group-List">
                        	<!-- <div class="row">
	                            <div class="col-1">1</div>
	                            <div class="col-1"><img src="https://www.xtmobile.vn/vnt_upload/product/04_2018/ip_X_gray_800x800.jpg" class="img-fluid"></div>
	                            <div class="col-2">Product 1</div>                   
	                            <div class="col-2">20.000.000 VNƒê</div>
	                            <div class="col-1">20</div>
	                            <div class="col-4">This is the product description.</div>
	                            <div class="col-1">
	                                <button type="button" class="btn btn-outline-danger">Delete</button>
	                            </div>
	                        </div> -->
                        </section>
                    	<!-- End of the product list group -->
                    </main>
                </div>
            </div>
        </div>
        <footer>
            Product Management System - 2021
        </footer>  

        <script type="text/javascript">
            $(document).ready(function () {
                let products, brands;
                $.get(
                    'http://45.32.46.181/getProducts.php',
                    {GetProducts: "All"},
                    function (data) {
                        products = data;
                        products.sort(compareQuantity);
                        ShowProducts(products);
                    }, "json"
                );

                $.get(
                    'http://45.32.46.181/getProducts.php',
                    {GetProducts: "Brand"},
                    function (data) {
                        brands = data;
                        ShowBrands(brands);
                    }, "json"
                );

                function ShowProducts (productList){
                    let s = "";
                    let i = 0;
                    for(let p of productList){
                        s+=`<div class="row">
                                <div class="col-1">${++i}</div>
                                <div class="col-1"><img src="${p.Image_URL}" class="img-fluid"></div>
                                <div class="col-2">${p.Name}</div>                   
                                <div class="col-2">${p.Price}</div>
                                <div class="col-1">${p.Quantity}</div>
                                <div class="col-4">${p.Description}</div>
                                <div class="col-1">
                                    <button data-id="${p.Code}" type="button" class="btn btn-outline-danger" id="del">Delete</button>
                                </div>
                            </div>`;
                    }
                    $(".group-List").html("");
                    $(".group-List").append(s);

                }

                function ShowBrands (brandList){
                    let _s = "", _option;

                    for(let b of brandList){
                        _s +=`<li>${b}</li>`;
                        _option += `<option value="${b}">${b}</option>`;
                    }
                    $(".BrandList").append(_s);
                    $("#option").append(_option);
                }

                function compareQuantity(a,b) {
                    if (a.Quantity < b.Quantity) {
                        return 1;
                    }
                    if (a.Quantity > b.Quantity) {
                        return -1;
                    }
                    return 0;
                }

                $("#btn-add").click(function(){
                    let name =$("#name").val();
                    let price =$("#price").val();
                    let quantity =$("#quantity").val();
                    let img =$("#img").val();
                    let des = $("#description").val();
                    let brand = $("#option").val();

                    products.unshift({
                        "Code":brand,
                        "Name":name,
                        "Price":price,
                        "Quantity":quantity,
                        "Description":des,
                        "Image_URL": img,
                        "CateCode":brand
                    });
                    ShowProducts(products);
                });

                $(".group-List").on("click","#del",function(){
                    let _confirm = confirm("Are you sure?");
                    if(_confirm){

                        let code = $(this).attr("data-id");

                        for(let i in products){
                            if (products[i].Code == code) {
                                products.splice(i,1);
                                break;
                            }
                        }
                        ShowProducts(products);
                    }
                });

                $(".BrandList").on("click","li",function(){
        
                    let brandName = $(this).text();

                    let tempList = [];

                    for(let p of products){
                        if (p.CateCode == brandName) {
                            tempList.push(p);
                        }
                    }
                    ShowProducts(tempList);
                    
                });

                $("#btn-search").click(function () {
                    let _ans = "";
                    let list = [];
                    let _string =$("#search").val();

                    for (let s of products){
                        if(s.Name.indexOf(_string) > -1){
                            list.push(s);
                        }
                    }

                    ShowProducts(list);
                });

            });
        </script>
    </body>

   
</html> 